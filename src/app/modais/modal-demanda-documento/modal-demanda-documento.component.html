<div id="html-to-pdf">
  <p-timeline *ngIf="showTimeline" [value]="timeline" align="top" layout="horizontal">
    <ng-template pTemplate="marker" let-event>
      <span class="custom-marker shadow-2" [style.backgroundColor]="event.color">
        <i [ngClass]="event.icon"></i>
      </span>
    </ng-template>
    <ng-template pTemplate="opposite" let-event>
      <span [style.fontWeight]="event.fontWeight" class="TitulosRodape">
        {{ event.status }}
      </span>
    </ng-template>
    <!-- <ng-template pTemplate="content" let-event>
  </ng-template> -->
  </p-timeline>

  <p class="paragrafo-inicial" *ngIf="documentoEmAta == false">
    <b class="me-2">01</b>
    <span>
      <div class="d-flex align-items-center justify-content-between">
        <a [href]="['http://localhost:8081/demanda/pdf/' + dadosDemanda?.codigoDemanda]">
          <i class="bi bi-download me-3" style="font-size: 25px;"></i>

        </a>
        <img style="width: 60px" src="https://logodownload.org/wp-content/uploads/2019/09/weg-logo.png" alt="" />
      </div>
    </span>
  </p>

  <mat-dialog-content class="mat-typography" [ngStyle]="{ 'overflow': (documentoEmAta ? 'hidden' : 'hidden') }">
    <p-scrollPanel [style]="{ width: '100%', height: '70vh' }" styleClass="custombar1">
      <h4 mat-dialog-title class="d-flex justify-content-between">
        <span><b>SOLICITANTE: </b>{{ dadosDemanda?.solicitanteDemanda?.nomeUsuario }}</span>
        <span><b>DATA: </b> {{ dadosDemanda?.inicioExDemandaProposta }}</span>
      </h4>
      <h4>
        <b>DEPARTAMENTO: </b>
        {{
        dadosDemanda?.solicitanteDemanda?.departamentoUsuario
        ?.nomeDepartamento
        }}
      </h4>
      <h4 class="d-flex justify-content-center">
        <b>{{ dadosDemanda?.tituloDemanda }} –
          {{ dadosDemanda?.codigoDemanda }}</b>
      </h4>
      <!-- <p><b>Tamanho da Demanda: </b>{{dadosDemanda?.tamanhoDemandaAnalista}}</p> -->

      <h4><b>Objetivo: </b></h4>
      <p [innerHTML]="dadosDemanda?.objetivoDemanda">
      </p>

      <h4><b>Situação Atual: </b></h4>
      <p [innerHTML]="dadosDemanda?.situacaoAtualDemanda">
      </p>
      <div *ngIf="dadosDemanda?.beneficioRealDemanda != null">
        <h4>
          <b>Beneficio Real: </b>{{ dadosDemanda?.beneficioRealDemanda?.valorBeneficio }} mensais
        </h4>
        <p>
          <b>Memória de cálculo do benefício real: </b>
        </p>
        <ul>
          <li>
            {{ dadosDemanda?.beneficioRealDemanda?.memoriaDeCalculoBeneficio }}
          </li>
        </ul>
        <h4>
          <b>Beneficio Potencial: </b>{{ dadosDemanda?.beneficioPotencialDemanda?.valorBeneficio }} mensais
        </h4>
        <p>
          <b>Memória de cálculo do benefício potencial: </b>
        </p>
        <ul>
          <li>
            {{
            dadosDemanda?.beneficioPotencialDemanda?.memoriaDeCalculoBeneficio
            }}
          </li>
        </ul>
        <h4>
          <b>Beneficio Qualitativo: </b>
        </h4>
        <ul>
          <li>
            {{ dadosDemanda?.beneficioQualitativoDemanda }}
          </li>
        </ul>
      </div>
      <p>
        <b>Frequência de uso do sistema: </b>
        {{dadosDemanda?.frequenciaDeUsoDemanda}}
      </p>
      <div class="fazer ng-if"
        *ngIf="dadosDemanda?.statusDemanda == 'ASSESSMENT' || dadosDemanda?.statusDemanda == 'BUSINESS_CASE'">
        <h4><b>Escopo do Projeto: </b></h4>

        {{dadosDemanda?.escopoDemanda}}
        <h4>
          <b>Resultados Esperados (Qualitativos): </b>
          {{dadosDemanda?.beneficioQualitativoDemanda}}
        </h4>
        <h4>
          <b>Resultados Esperados (Ganhos potenciais): </b>
          {{dadosDemanda?.beneficioPotencialDemanda?.valorBeneficio}}
          {{dadosDemanda?.beneficioPotencialDemanda?.memoriaDeCalculoBeneficio}}
        </h4>

        <!-- <p *ngFor="let calcularDados of dadosDemanda?.recursosProposta">
          <b >
            Custos totais do projeto: R${{calcularDados.quantidadeHorasRecurso * calcularDados.valorHoraRecurso}}</b> 
          <span *ngIf="calcularDados.tipoDespesaRecurso == 'externo'">
          <br> Total despesas recursos externos (Desembolso): R$30.000,00 </span>
          <span *ngIf="calcularDados.tipoDespesaRecurso == 'interno'">
          <br> Total despesa recursos internos: R$20.000,00</span>
        </p> -->
        <p *ngFor="let calcularDados of dadosDemanda?.recursosProposta">
          <b>
            Custos totais do projeto:</b> R${{calcularDados.quantidadeHorasRecurso * calcularDados.valorHoraRecurso}}
        </p>
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Recursos Necessários</th>
              <th scope="col">Tipo da Despesa</th>
              <th scope="col">Perfil da Despesa</th>
              <th scope="col">CC Pagante</th>
              <th scope="col">Qtd de Horas</th>
              <th scope="col">Valor da Hora</th>
              <th scope="col">Período de Execução (Mensal)</th>
            </tr>
          </thead>

          <tbody *ngFor="let itemRecurso of dadosDemanda?.recursosProposta" class="table-group-divider">
            <tr>
              <td>
                {{itemRecurso.nomeRecurso}}
              </td>
              <td>
                {{itemRecurso.tipoDespesaRecurso}}
              </td>
              <td>
                {{itemRecurso.perfilDespesaRecurso}}
              </td>
              <td>
                <p *ngFor="let centroCustoPagante of itemRecurso.centroCustoRecurso">
                  {{centroCustoPagante.nomeCentroCusto}}: {{centroCustoPagante.porcentagemCentroCusto}}%
                </p>
              </td>
              <td>
                {{itemRecurso.quantidadeHorasRecurso}}
              </td>
              <td>
                {{itemRecurso.valorHoraRecurso}}
              </td>
              <td>
                {{itemRecurso.periodoExMesesRecurso}}
              </td>
            </tr>
          </tbody>
        </table>

        <p>
          <b>
            Período de execução:
          </b>
          {{dadosDemanda?.inicioExDemandaProposta}} à {{dadosDemanda?.fimExDemandaProposta}}
        </p>
        <p>
          <b>
            Payback:
          </b> {{dadosDemanda?.paybackProposta}}
        </p>
      </div>
      <h4><b>DOCUMENTOS: </b>
        <a *ngFor="let arquivo of dadosDemanda?.arquivosDemanda" role="button" (click)="download(arquivo)">
          {{ arquivo.nomeArquivo }}
        </a>
      </h4>
    </p-scrollPanel>
  </mat-dialog-content>

  <mat-dialog-actions class="d-flex justify-content-between" *ngIf="documentoEmAta == false">
    <button class="btn btn-outline-primary me-2" [mat-dialog-close]="true">
      Cancelar
    </button>
    <div>
      <button class="btn btn-danger me-2" *ngIf="showbotoesAprovarDemanda" (click)="openModalReprovacao()">
        Reprovar demanda
      </button>
      <button class="btn btn-primary" *ngIf="showbotoesAprovarDemanda" (click)="enviarDecisao(1)">
        Aprovar demanda
      </button>
    </div>
  </mat-dialog-actions>
</div>