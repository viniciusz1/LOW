<div class="row" scroll-spy>
  <div class="col-2">
    <div>
      <nav
        id="navbar-example3"
        style="position: fixed; top: 30vh; left: 4vw"
        class="h-100 flex-column align-items-stretch pe-4"
      >
        <nav class="nav nav-pills flex-column">
          <a
            class="nav-link mt-5"
            spyOn="target-1"
            activeClass="active"
            href="#target-1"
            style="font-size: 0.9rem"
            >Dados Gerais</a
          >
          <a
            class="nav-link"
            spyOn="beneficios"
            activeClass="active"
            href="#beneficios"
            style="font-size: 0.9rem"
            >Benefícios</a
          >
          <nav
            class="nav nav-pills flex-column"
            style="font-size: 0.75rem"
          ></nav>
          <a
            class="nav-link"
            spyOn="target-3"
            activeClass="active"
            href="#target-3"
            style="font-size: 0.9rem"
            >Documentos</a
          >
          <nav
            class="nav nav-pills flex-column"
            style="font-size: 0.75rem"
          ></nav>
          <a
            class="nav-link"
            spyOn="target-4"
            activeClass="active"
            href="#target-4"
            style="font-size: 0.9rem"
            >Custos Totais</a
          >
          <nav
            class="nav nav-pills flex-column"
            style="font-size: 0.75rem"
          ></nav>
          <a
            class="nav-link"
            spyOn="target-5"
            activeClass="active"
            href="#target-5"
            style="font-size: 0.9rem"
            >Finalizar</a
          >
          <nav
            class="nav nav-pills flex-column"
            style="font-size: 0.75rem"
          ></nav>
        </nav>
      </nav>
    </div>
  </div>

  <div class="tela-corrida col-10 border-start">
    <div>
      <div class="analista">
        <div
          class="campo"
          style="
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0px;
          "
          *ngIf="aparecerProposta"
        >
          <div class="div-preenchida">
            <div
              style="
                background-color: rgb(249 249 249);
                border: 1px solid #cac9c9;
                padding: 10px;
                border-radius: 5px;
                margin-top: 1vh;
              "
            >
              <h6 style="font-weight: 500">
                Campos obrigatórios para salvar a proposta:
              </h6>
              <div class="d-flex justify-content-between">
                <div class="titulo" style="display: grid" id="item-1-1">
                  <label style="font-weight: 500">
                    Prazo para elaboração da proposta:
                  </label>
                  <input
                    style="width: 14vw !important"
                    type="date"
                    pInputText
                    class="input"
                  />
                </div>
                <div class="titulo" style="display: grid" id="item-1-1">
                  <label style="font-weight: 500"> Código PPM: </label>
                  <input
                    style="width: 41vw !important"
                    type="text"
                    pInputText
                    class="input"
                  />
                </div>
              </div>
              <div class="titulo" style="display: grid" id="item-1-1">
                <label style="font-weight: 500"> Link Jira: </label>
                <input
                  style="width: 57.5vw !important"
                  type="text"
                  pInputText
                  class="input"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div [formGroup]="demandaForm" (ngSubmit)="onSubmitDemanda()">
        <div
          spyTarget="etapa-1"
          style="
            display: grid;
            justify-content: center !important;
            margin-top: 1vh;
          "
          class="etapa-1"
        >
          <div
            class="beneficios"
            style="
              display: grid;
              align-items: center;
              justify-content: space-between;
            "
          >
            <div class="titulo" style="display: grid" id="item-1-1">
              <label style="font-weight: 500"> Título: </label>
              <input
                type="text"
                pInputText
                formControlName="tituloDemanda"
                class="input"
              />
            </div>
            <div class="situacao-atual" style="display: grid" id="item-1-2">
              <label style="font-weight: 500"> Situação Atual: </label>
              <div style="display: flex">
                <input
                  type="text"
                  formControlName="situacaoAtualDemanda"
                  pInputText
                  class="input"
                />
              </div>
            </div>
            <div class="objetivo" style="display: grid" id="item-1-3">
              <label style="font-weight: 500"> Objetivo: </label>
              <div style="display: flex">
                <input
                  type="text"
                  formControlName="objetivoDemanda"
                  pInputText
                  class="input"
                />
              </div>
            </div>
            <div
              class="real"
              style="display: flex; justify-content: first baseline"
              id="item-1-4"
            >
              <div class="ben-real" style="display: grid">
                <label style="font-weight: 500"> Centros de Custo: </label>
                <span class="p-float-label">
                  <p-multiSelect
                    style="width: 58.5vw"
                    [options]="centrosCusto"
                    [(ngModel)]="selectedCentros"
                    defaultLabel="Selecione os Centros de Custo"
                    optionLabel="centro"
                    display="chip"
                    formControlName="centroCustoDemanda"
                  >
                  </p-multiSelect>
                </span>
              </div>
            </div>
          </div>
        </div>

        <div
          spyTarget="etapa-2"
          style="
            display: grid;
            justify-content: center !important;
            margin-top: 1vh;
          "
          class="etapa-2"
        >
          <div
            class="beneficios"
            style="
              display: grid;
              align-items: center;
              justify-content: space-between;
            "
          >
            <div formGroupName="beneficioRealDemanda">
              <div class="titulo" style="display: grid" id="item-2-1">
                <label style="font-weight: 500"> Benefício Real: </label>
                <div style="display: flex; justify-content: space-between">
                  <input
                    style="width: 55vw !important"
                    type="text"
                    pInputText
                    class="input"
                    formControlName="valor"
                  />
                  <select
                    name="Moeda"
                    style="
                      background-color: #00579d;
                      color: #fff;
                      border-radius: 5px;
                      padding: 4px;
                      margin: 5px;
                      border: none;
                      outline: none;
                    "
                    formControlName="moeda"
                  >
                    <option value="valor1">BR</option>
                  </select>
                </div>
              </div>
              <div class="situacao-atual" style="display: grid" id="item-1-2">
                <label style="font-weight: 500">
                  Memória de Cálculo do Benefício Real:
                </label>
                <div style="display: flex">
                  <textarea
                    style="width: 58.5vw"
                    [rows]="5"
                    [cols]="30"
                    [autoResize]="true"
                    pInputTextarea
                    formControlName="memoriaCalculo"
                  ></textarea>
                </div>
              </div>
            </div>
            <div formGroupName="beneficioPotencialDemanda">
              <div class="objetivo" style="display: grid" id="item-1-3">
                <label style="font-weight: 500"> Benefício Potencial: </label>
                <div style="display: flex; justify-content: space-between">
                  <input
                    style="width: 55vw !important"
                    type="text"
                    pInputText
                    class="input"
                    formControlName="valor"
                  />
                  <select
                    name="Moeda"
                    style="
                      background-color: #00579d;
                      color: #fff;
                      border-radius: 5px;
                      padding: 4px;
                      margin: 5px;
                      border: none;
                      outline: none;
                    "
                    formControlName="moeda"
                  >
                    <option value="valor1">BR</option>
                  </select>
                </div>
              </div>
              <div
                class="real"
                style="display: flex; justify-content: first baseline"
                id="item-1-4"
              >
                <div class="ben-real" style="display: grid">
                  <label style="font-weight: 500">
                    Memória de Cálculo do Benefício Potencial:
                  </label>
                  <div style="display: flex">
                    <textarea
                      style="width: 58.5vw"
                      [rows]="5"
                      [cols]="30"
                      [autoResize]="true"
                      pInputTextarea
                      formControlName="memoriaCalculo"
                    ></textarea>
                  </div>
                </div>
              </div>
            </div>
            <div
              class="real"
              style="display: flex; justify-content: first baseline"
              id="item-1-4"
            >
              <div class="ben-real" style="display: grid">
                <label style="font-weight: 500"> Benefício Qualitativo: </label>
                <div style="display: flex">
                  <textarea
                    style="width: 58.5vw"
                    [rows]="5"
                    [cols]="30"
                    [autoResize]="true"
                    pInputTextarea
                    formControlName="beneficioQualitativoDemanda"
                  ></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          spyTarget="target-3"
          style="
            display: grid;
            justify-content: center !important;
            margin-top: 1vh;
          "
          class="etapa-3"
        >
          <div
            class="beneficios"
            style="
              display: grid;
              align-items: center;
              justify-content: space-between;
            "
          >
            <div class="titulo" style="display: grid" id="item-2-1">
              <label style="font-weight: 500">
                Frequência de Uso do Sistema:
              </label>
              <div style="display: flex">
                <p-dropdown
                  [options]="opcoesDeTamanho"
                  optionLabel="name"
                  placeholder="Selecione a frequência"
                  formControlName="frequenciaDeUsoDemanda"
                ></p-dropdown>
              </div>
            </div>
            <div
              class="situacao-atual"
              style="display: grid; width: 58.5vw"
              id="item-1-2"
            >
              <label style="font-weight: 500"> Anexar Documento: </label>
              <p-fileUpload
                name="myfile[]"
                url="./upload.php"
                [multiple]="true"
              ></p-fileUpload>
            </div>
          </div>
        </div>
      </div>
      <div
        *ngIf="aparecerProposta"
        class="d-grid justify-content-center my-3"
        spyTarget="target-4"
        style="
          display: grid;
          justify-content: center !important;
          margin-top: 1vh;
        "
      >
        <div
          class="beneficios"
          style="
            display: grid;
            align-items: center;
            justify-content: space-between;
          "
        >
          <p-table
            [value]="recursos"
            dataKey="id"
            editMode="row"
            [tableStyle]="{ width: '58.5vw' }"
            id="item-4-1"
          >
            <ng-template pTemplate="header">
              <tr>
                <th style="width: 12.5% !important; border: 1px solid #dee2e6">
                  Recurso necessário
                </th>
                <th style="width: 12.5% !important; border: 1px solid #dee2e6">
                  Tipo da despesa
                </th>
                <th style="width: 12.5% !important; border: 1px solid #dee2e6">
                  Perfil da despesa
                </th>
                <th style="width: 12.5% !important; border: 1px solid #dee2e6">
                  Quantidade de horas
                </th>
                <th style="width: 12.5% !important; border: 1px solid #dee2e6">
                  Valor da hora
                </th>
                <th style="width: 12.5% !important; border: 1px solid #dee2e6">
                  Valor total da despesa
                </th>
                <th style="width: 12.5% !important; border: 1px solid #dee2e6">
                  Período de execução(Em meses)
                </th>
                <th style="width: 12.5% !important; border: 1px solid #dee2e6">
                  Centros de custos pagantes
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-recursos>
              <tr>
                <td pEditableColumnb style="border: 1px solid #dee2e6">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <input
                        pInputText
                        type="text"
                        [(ngModel)]="recursos.nomeRecurso"
                        required
                      />
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{ recursos.nomeRecurso }}
                    </ng-template>
                  </p-cellEditor>
                </td>
                <td pEditableColumn style="border: 1px solid #dee2e6">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <p-dropdown
                        [options]="['Interno', 'Externo']"
                        appendTo="body"
                        [(ngModel)]="recursos.perfilDespesa"
                        [style]="{ width: '100%' }"
                      >
                      </p-dropdown>
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{ recursos.tipoDespesa }}
                    </ng-template>
                  </p-cellEditor>
                </td>
                <td pEditableColumn style="border: 1px solid #dee2e6">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <p-dropdown
                        [options]="['Hardware', 'Software', 'Corporativo']"
                        appendTo="body"
                        [(ngModel)]="recursos.perfilDespesa"
                        [style]="{ width: '100%' }"
                      >
                      </p-dropdown>
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{ recursos.perfilDespesa }}
                    </ng-template>
                  </p-cellEditor>
                </td>
                <td pEditableColumn style="border: 1px solid #dee2e6">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <input
                        pInputText
                        type="text"
                        [(ngModel)]="recursos.quantidadeHoras"
                        required
                      />
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{ recursos.quantidadeHoras }}
                    </ng-template>
                  </p-cellEditor>
                </td>
                <td pEditableColumn style="border: 1px solid #dee2e6">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <input
                        pInputText
                        type="text"
                        [(ngModel)]="recursos.valorHora"
                        required
                      />
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{ recursos.valorHora }}
                    </ng-template>
                  </p-cellEditor>
                </td>
                <td pEditableColumn style="border: 1px solid #dee2e6">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <input
                        pInputText
                        type="text"
                        [(ngModel)]="recursos.valorTotalDespesa"
                        required
                      />
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{ recursos.valorTotalDespesa }}
                    </ng-template>
                  </p-cellEditor>
                </td>
                <td pEditableColumn style="border: 1px solid #dee2e6">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <input
                        pInputText
                        type="text"
                        [(ngModel)]="recursos.periodoExMeses"
                        required
                      />
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{ recursos.periodoExMeses }}
                    </ng-template>
                  </p-cellEditor>
                </td>
                <td pEditableColumn style="border: 1px solid #dee2e6">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <input
                        pInputText
                        type="text"
                        [(ngModel)]="recursos.centrosCustoPagantes"
                        required
                      />
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{ recursos.centrosCustoPagantes }}
                    </ng-template>
                  </p-cellEditor>
                </td>
              </tr>
              <tr>
                <td>
                  <button class="btn btn-primary">
                    <i class="bi bi-plus-lg"></i>
                  </button>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>

      <div
        *ngIf="aparecerProposta"
        spyTarget="target-5"
        style="
          display: grid;
          justify-content: center !important;
          margin-top: 1vh;
        "
        class="etapa-5"
      >
        <div
          class="beneficios"
          style="
            display: grid;
            align-items: center;
            justify-content: space-between;
          "
        >
          <div class="titulo" style="display: grid" id="item-2-1">
            <label style="font-weight: 500"> Escopo da Demanda: </label>
            <div style="display: flex">
              <form [formGroup]="form">
                <div
                  class="NgxEditor__Wrapper"
                  style="
                    border: 1px solid #dee2e6 !important;
                    border-radius: 5px !important;
                    width: 58.5vw;
                    height: 50vh;
                  "
                >
                  <ngx-editor-menu [editor]="editor" [toolbar]="toolbar">
                  </ngx-editor-menu>
                  <ngx-editor [editor]="editor" formControlName="editorContent">
                  </ngx-editor>
                </div>
              </form>
            </div>
          </div>
          <div
            class="flex"
            style="
              display: flex;
              justify-content: space-between;
              margin-top: 1vh;
            "
          >
            <div class="situacao-atual" style="display: grid" id="item-1-2">
              <label style="font-weight: 500; margin: 5px">
                Periodo de execução da demanda:
              </label>
              <div style="display: flex">
                <p-calendar
                  [(ngModel)]="inicioData"
                  placeholder="Início"
                  dateFormat="dd/mm/yy"
                  style="width: 15vw"
                ></p-calendar>
                <div style="margin-right: 2vw"></div>
                <p-calendar
                  [(ngModel)]="fimData"
                  placeholder="Fim"
                  dateFormat="dd/mm/yy"
                  [minDate]="inicioData"
                  style="width: 15vw"
                ></p-calendar>
              </div>
            </div>
            <div class="objetivo" style="display: grid" id="item-1-3">
              <label style="font-weight: 500"> Payback Simples: </label>
              <div style="display: flex">
                <p-inputNumber
                  [(ngModel)]="payback"
                  mode="decimal"
                  [minFractionDigits]="2"
                  [maxFractionDigits]="2"
                ></p-inputNumber>
              </div>
            </div>
          </div>
          <div
            class="real"
            style="display: flex; justify-content: first baseline"
            id="item-1-4"
          >
            <div class="ben-real" style="display: grid">
              <label style="font-weight: 500; margin: 5px">
                Responsáveis pelo Negócio:
              </label>
              <div style="display: flex">
                <p-multiSelect
                  [options]="Responsaveis"
                  [(ngModel)]="selectedResponsaveis"
                  defaultLabel="Selecione os Responsaveis"
                  optionLabel="nome"
                  display="chip"
                >
                </p-multiSelect>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        class="d-flex justify-content-between"
        style="margin-top: 2vh !important; margin-bottom: 2vh"
      >
        <div>
          <button class="btn btn-danger me-3">Cancelar</button>
        </div>
        <button class="btn btn-primary" (click)="onSubmitDemanda()">
          Finalizar
        </button>
      </div>
    </div>
  </div>
</div>
